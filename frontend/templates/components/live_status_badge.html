{#
Live Status Badge Component

Shows real-time pipeline status for a job using WebSocket queue state.
Status types:
- pending: Yellow pulse with queue position
- running: Blue spinner
- failed: Red with click to view error
- completed: Green checkmark (fades after 5s)

Usage:
{% include 'components/live_status_badge.html' with context %}
Requires job_id to be in context.
#}

<div
    x-data="liveStatusBadge('{{ job_id }}')"
    x-init="init()"
    class="inline-flex"
>
    {# Pending Badge #}
    <template x-if="status === 'pending'">
        <button
            @click.stop="openCLI()"
            class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium transition-all cursor-pointer hover:scale-105"
            style="background-color: rgba(234, 179, 8, 0.15); color: #ca8a04;"
            :title="'Queued at position #' + position"
        >
            <span class="w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse"></span>
            <span x-text="'#' + position"></span>
        </button>
    </template>

    {# Running Badge #}
    <template x-if="status === 'running'">
        <button
            @click.stop="openCLI()"
            class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium transition-all cursor-pointer hover:scale-105"
            style="background-color: rgba(59, 130, 246, 0.15); color: #2563eb;"
            title="Click to view logs"
        >
            <svg class="w-3 h-3 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
            <span>Running</span>
        </button>
    </template>

    {# Failed Badge #}
    <template x-if="status === 'failed'">
        <button
            @click.stop="showError()"
            class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium transition-all cursor-pointer hover:scale-105"
            style="background-color: rgba(239, 68, 68, 0.15); color: #dc2626;"
            :title="error || 'Pipeline failed'"
        >
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
            <span>Failed</span>
        </button>
    </template>

    {# Completed Badge (fades) #}
    <template x-if="status === 'completed'">
        <span
            class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium transition-all"
            :class="{ 'opacity-0': fadeOut }"
            style="background-color: rgba(34, 197, 94, 0.15); color: #16a34a;"
        >
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            <span>Done</span>
        </span>
    </template>
</div>
