{#
Compact Extracted JD Display Component

Reusable component for displaying ExtractedJD in side-by-side comparison.
Designed to be more compact than the full display for A/B comparison.

Usage:
    {% with extracted=job.extracted_jd, label="GPT-4o", color="blue" %}
        {% include 'components/extracted_jd_compact.html' %}
    {% endwith %}

Parameters:
    extracted: ExtractedJD dict with role_category, competency_weights, etc.
    label: Model label (e.g., "GPT-4o", "Claude Opus 4.5")
    color: Tailwind color name for theming (blue, purple, etc.)
#}

<div class="extracted-jd-compact space-y-3">
    {# Model Label Badge #}
    <div class="flex items-center gap-2 mb-2">
        <span class="px-2 py-1 text-xs font-medium rounded bg-{{ color }}-100 text-{{ color }}-800">
            {{ label }}
        </span>
        {% if extracted.role_category %}
        <span class="px-2 py-0.5 text-xs rounded bg-gray-100 text-gray-700">
            {{ extracted.role_category|replace('_', ' ')|title }}
        </span>
        {% endif %}
    </div>

    {# Competency Weights - Compact Grid #}
    {% if extracted.competency_weights %}
    <div class="grid grid-cols-4 gap-1 text-center">
        <div class="p-1 bg-{{ color }}-50 rounded">
            <div class="text-lg font-bold text-{{ color }}-700">{{ extracted.competency_weights.delivery }}%</div>
            <div class="text-[10px] text-gray-500">Delivery</div>
        </div>
        <div class="p-1 bg-{{ color }}-50 rounded">
            <div class="text-lg font-bold text-{{ color }}-700">{{ extracted.competency_weights.process }}%</div>
            <div class="text-[10px] text-gray-500">Process</div>
        </div>
        <div class="p-1 bg-{{ color }}-50 rounded">
            <div class="text-lg font-bold text-{{ color }}-700">{{ extracted.competency_weights.architecture }}%</div>
            <div class="text-[10px] text-gray-500">Arch</div>
        </div>
        <div class="p-1 bg-{{ color }}-50 rounded">
            <div class="text-lg font-bold text-{{ color }}-700">{{ extracted.competency_weights.leadership }}%</div>
            <div class="text-[10px] text-gray-500">Lead</div>
        </div>
    </div>
    {% endif %}

    {# Top Keywords - Limited to 8 #}
    {% if extracted.top_keywords %}
    <div>
        <h4 class="text-[10px] font-semibold text-gray-500 uppercase mb-1">Keywords</h4>
        <div class="flex flex-wrap gap-1">
            {% for keyword in extracted.top_keywords[:8] %}
            <span class="px-1.5 py-0.5 text-[10px] rounded bg-{{ color }}-50 text-{{ color }}-700">
                {{ keyword }}
            </span>
            {% endfor %}
            {% if extracted.top_keywords|length > 8 %}
            <span class="px-1.5 py-0.5 text-[10px] rounded bg-gray-100 text-gray-500">
                +{{ extracted.top_keywords|length - 8 }}
            </span>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {# Technical Skills - Limited to 6 #}
    {% if extracted.technical_skills %}
    <div>
        <h4 class="text-[10px] font-semibold text-gray-500 uppercase mb-1">Tech Skills</h4>
        <div class="flex flex-wrap gap-1">
            {% for skill in extracted.technical_skills[:6] %}
            <span class="px-1.5 py-0.5 text-[10px] rounded bg-green-50 text-green-700">
                {{ skill }}
            </span>
            {% endfor %}
            {% if extracted.technical_skills|length > 6 %}
            <span class="px-1.5 py-0.5 text-[10px] rounded bg-gray-100 text-gray-500">
                +{{ extracted.technical_skills|length - 6 }}
            </span>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {# Key Responsibilities - Limited to 3 #}
    {% if extracted.responsibilities %}
    <div>
        <h4 class="text-[10px] font-semibold text-gray-500 uppercase mb-1">Responsibilities</h4>
        <ul class="space-y-0.5 text-xs text-gray-700">
            {% for resp in extracted.responsibilities[:3] %}
            <li class="flex items-start">
                <span class="text-{{ color }}-500 mr-1 flex-shrink-0">*</span>
                <span class="line-clamp-2">{{ resp }}</span>
            </li>
            {% endfor %}
            {% if extracted.responsibilities|length > 3 %}
            <li class="text-gray-400 text-[10px] ml-3">+{{ extracted.responsibilities|length - 3 }} more</li>
            {% endif %}
        </ul>
    </div>
    {% endif %}

    {# Implied Pain Points - Limited to 2 #}
    {% if extracted.implied_pain_points %}
    <div>
        <h4 class="text-[10px] font-semibold text-gray-500 uppercase mb-1">Pain Points</h4>
        <ul class="space-y-0.5 text-xs text-gray-700">
            {% for pp in extracted.implied_pain_points[:2] %}
            <li class="flex items-start">
                <span class="text-orange-500 mr-1 flex-shrink-0">!</span>
                <span class="line-clamp-2">{{ pp }}</span>
            </li>
            {% endfor %}
            {% if extracted.implied_pain_points|length > 2 %}
            <li class="text-gray-400 text-[10px] ml-3">+{{ extracted.implied_pain_points|length - 2 }} more</li>
            {% endif %}
        </ul>
    </div>
    {% endif %}

    {# Metadata (if available) #}
    {% if metadata %}
    <div class="pt-2 border-t border-gray-100 text-[10px] text-gray-400">
        <span>{{ metadata.model }}</span>
        {% if metadata.duration_ms %}
        <span class="ml-2">{{ (metadata.duration_ms / 1000)|round(1) }}s</span>
        {% endif %}
    </div>
    {% endif %}
</div>
