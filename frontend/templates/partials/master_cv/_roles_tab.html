<!-- Work Experience Roles Tab -->
<div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
    <!-- Left Sidebar: Role List -->
    <div class="lg:col-span-3">
        <div class="panel p-4 sticky top-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold" style="color: var(--text-primary);">Roles</h3>
                <button onclick="masterCVEditor.showAddRoleModal()"
                        class="btn btn-ghost btn-xs flex items-center gap-1"
                        title="Add new role">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                </button>
            </div>
            <div id="roles-list" class="space-y-1">
                <!-- Role items will be rendered here by JS -->
                <div class="text-sm italic p-3" style="color: var(--text-tertiary);">Loading roles...</div>
            </div>
        </div>
    </div>

    <!-- Right Content: Role Editor -->
    <div class="lg:col-span-9">
        <div id="role-editor-container" class="space-y-6">
            <!-- Empty state when no role selected -->
            <div id="no-role-selected" class="panel p-12 text-center">
                <svg class="w-16 h-16 mx-auto mb-4" style="color: var(--text-tertiary);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
                <p class="text-lg font-medium" style="color: var(--text-secondary);">Select a role to edit</p>
                <p class="text-sm mt-1" style="color: var(--text-tertiary);">Choose from the list on the left or add a new role</p>
            </div>

            <!-- Role editor (hidden until role selected) -->
            <div id="role-editor" class="hidden space-y-6">
                <!-- Role Header -->
                <div class="panel p-5">
                    <div class="flex items-start justify-between mb-4">
                        <h3 class="text-lg font-semibold" style="color: var(--text-primary);">
                            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                            </svg>
                            Role Details
                        </h3>
                        <button onclick="masterCVEditor.confirmDeleteRole()"
                                class="btn btn-ghost btn-xs text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"
                                title="Delete this role">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Company</label>
                            <input type="text"
                                   id="role-company"
                                   class="form-input w-full"
                                   onchange="masterCVEditor.updateRoleField('company', this.value)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Title</label>
                            <input type="text"
                                   id="role-title"
                                   class="form-input w-full"
                                   onchange="masterCVEditor.updateRoleField('title', this.value)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Location</label>
                            <input type="text"
                                   id="role-location"
                                   class="form-input w-full"
                                   onchange="masterCVEditor.updateRoleField('location', this.value)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Period</label>
                            <input type="text"
                                   id="role-period"
                                   class="form-input w-full"
                                   placeholder="e.g., 2020-Present"
                                   onchange="masterCVEditor.updateRoleField('period', this.value)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Industry</label>
                            <input type="text"
                                   id="role-industry"
                                   class="form-input w-full"
                                   onchange="masterCVEditor.updateRoleField('industry', this.value)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Team Size</label>
                            <input type="text"
                                   id="role-team-size"
                                   class="form-input w-full"
                                   placeholder="e.g., 10+"
                                   onchange="masterCVEditor.updateRoleField('team_size', this.value)">
                        </div>
                    </div>
                    <div class="mt-4 flex items-center gap-4">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox"
                                   id="role-is-current"
                                   class="form-checkbox"
                                   onchange="masterCVEditor.updateRoleField('is_current', this.checked)">
                            <span class="text-sm font-medium" style="color: var(--text-secondary);">Current Role</span>
                        </label>
                    </div>
                </div>

                <!-- Skills & Keywords -->
                <div class="panel p-5">
                    <h3 class="text-lg font-semibold mb-4" style="color: var(--text-primary);">
                        <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                        </svg>
                        Skills & Keywords
                    </h3>

                    <!-- Keywords -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium" style="color: var(--text-secondary);">Keywords (for ATS matching)</label>
                            <button onclick="masterCVEditor.showAddChipModal('keywords')"
                                    class="btn btn-ghost btn-xs">+ Add</button>
                        </div>
                        <div id="role-keywords" class="flex flex-wrap gap-2 min-h-[2.5rem] p-2 rounded-lg border" style="border-color: var(--border-default); background-color: var(--bg-hover);">
                            <!-- Keyword chips rendered by JS -->
                        </div>
                    </div>

                    <!-- Hard Skills -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium" style="color: var(--text-secondary);">Hard Skills (Technical)</label>
                            <button onclick="masterCVEditor.showAddChipModal('hard_skills')"
                                    class="btn btn-ghost btn-xs">+ Add</button>
                        </div>
                        <div id="role-hard-skills" class="flex flex-wrap gap-2 min-h-[2.5rem] p-2 rounded-lg border" style="border-color: var(--border-default); background-color: var(--bg-hover);">
                            <!-- Hard skill chips rendered by JS -->
                        </div>
                    </div>

                    <!-- Soft Skills -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium" style="color: var(--text-secondary);">Soft Skills</label>
                            <button onclick="masterCVEditor.showAddChipModal('soft_skills')"
                                    class="btn btn-ghost btn-xs">+ Add</button>
                        </div>
                        <div id="role-soft-skills" class="flex flex-wrap gap-2 min-h-[2.5rem] p-2 rounded-lg border" style="border-color: var(--border-default); background-color: var(--bg-hover);">
                            <!-- Soft skill chips rendered by JS -->
                        </div>
                    </div>

                    <!-- Primary Competencies -->
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium" style="color: var(--text-secondary);">Primary Competencies</label>
                            <button onclick="masterCVEditor.showAddChipModal('primary_competencies')"
                                    class="btn btn-ghost btn-xs">+ Add</button>
                        </div>
                        <div id="role-primary-competencies" class="flex flex-wrap gap-2 min-h-[2.5rem] p-2 rounded-lg border" style="border-color: var(--border-default); background-color: var(--bg-hover);">
                            <!-- Competency chips rendered by JS -->
                        </div>
                    </div>
                </div>

                <!-- Achievements (TipTap Editor) -->
                <div class="panel p-5">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold" style="color: var(--text-primary);">
                            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            Achievements (Markdown)
                        </h3>
                        <div class="flex items-center gap-2">
                            <span id="role-markdown-indicator" class="text-xs px-2 py-1 rounded" style="background-color: var(--bg-hover); color: var(--text-tertiary);">
                                Synced
                            </span>
                        </div>
                    </div>
                    <!-- TipTap Editor Container -->
                    <div id="role-tiptap-container" class="border rounded-lg overflow-hidden" style="border-color: var(--border-default);">
                        <!-- Toolbar -->
                        <div id="role-tiptap-toolbar" class="flex flex-wrap items-center gap-1 p-2 border-b" style="border-color: var(--border-default); background-color: var(--bg-hover);">
                            <button onclick="masterCVEditor.editorCommand('toggleBold')" class="tiptap-btn" title="Bold (Ctrl+B)">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4h8a4 4 0 014 4 4 4 0 01-4 4H6z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 12h9a4 4 0 014 4 4 4 0 01-4 4H6z"/></svg>
                            </button>
                            <button onclick="masterCVEditor.editorCommand('toggleItalic')" class="tiptap-btn" title="Italic (Ctrl+I)">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 4h4m-2 0v16m-4 0h8"/></svg>
                            </button>
                            <div class="w-px h-5 mx-1" style="background-color: var(--border-default);"></div>
                            <button onclick="masterCVEditor.editorCommand('toggleHeading', {level: 2})" class="tiptap-btn" title="Heading 2">H2</button>
                            <button onclick="masterCVEditor.editorCommand('toggleHeading', {level: 3})" class="tiptap-btn" title="Heading 3">H3</button>
                            <div class="w-px h-5 mx-1" style="background-color: var(--border-default);"></div>
                            <button onclick="masterCVEditor.editorCommand('toggleBulletList')" class="tiptap-btn" title="Bullet List">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
                            </button>
                            <button onclick="masterCVEditor.editorCommand('toggleOrderedList')" class="tiptap-btn" title="Numbered List">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h14M7 12h14M7 16h14M3 8h.01M3 12h.01M3 16h.01"/></svg>
                            </button>
                        </div>
                        <!-- Editor Content -->
                        <div id="role-tiptap-editor" class="prose prose-sm max-w-none p-4 min-h-[300px] focus:outline-none" style="background-color: var(--bg-card);">
                            <!-- TipTap will mount here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Role Modal -->
<div id="add-role-modal" class="fixed inset-0 z-50 hidden">
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm" onclick="masterCVEditor.closeAddRoleModal()"></div>
    <div class="fixed inset-0 flex items-center justify-center p-4 pointer-events-none">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-lg w-full pointer-events-auto" style="background-color: var(--bg-card);">
            <div class="p-5">
                <h4 class="text-lg font-semibold mb-4" style="color: var(--text-primary);">Add New Role</h4>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Company Name</label>
                        <input type="text" id="new-role-company" class="form-input w-full" placeholder="e.g., Acme Corp">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Job Title</label>
                        <input type="text" id="new-role-title" class="form-input w-full" placeholder="e.g., Senior Software Engineer">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">Start Year</label>
                            <input type="number" id="new-role-start-year" class="form-input w-full" min="1990" max="2030" placeholder="2020">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1.5" style="color: var(--text-secondary);">End Year</label>
                            <input type="number" id="new-role-end-year" class="form-input w-full" min="1990" max="2030" placeholder="Leave empty if current">
                        </div>
                    </div>
                </div>
                <div class="flex justify-end gap-3 mt-6">
                    <button onclick="masterCVEditor.closeAddRoleModal()" class="btn btn-ghost">Cancel</button>
                    <button onclick="masterCVEditor.confirmAddRole()" class="btn btn-primary">Add Role</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Chip Modal (for keywords, skills) -->
<div id="add-chip-modal" class="fixed inset-0 z-50 hidden">
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm" onclick="masterCVEditor.closeAddChipModal()"></div>
    <div class="fixed inset-0 flex items-center justify-center p-4 pointer-events-none">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full pointer-events-auto" style="background-color: var(--bg-card);">
            <div class="p-5">
                <h4 id="add-chip-title" class="text-lg font-semibold mb-4" style="color: var(--text-primary);">Add Item</h4>
                <input type="text"
                       id="add-chip-input"
                       class="form-input w-full mb-4"
                       placeholder="Enter value..."
                       onkeydown="if(event.key === 'Enter') masterCVEditor.confirmAddChip()">
                <p class="text-xs mb-4" style="color: var(--text-tertiary);">Tip: Separate multiple items with commas</p>
                <div class="flex justify-end gap-3">
                    <button onclick="masterCVEditor.closeAddChipModal()" class="btn btn-ghost">Cancel</button>
                    <button onclick="masterCVEditor.confirmAddChip()" class="btn btn-primary">Add</button>
                </div>
            </div>
        </div>
    </div>
</div>
