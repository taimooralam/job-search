<!-- Opportunity detail modal content -->
{% if toast %}
<div class="mb-3 px-3 py-2 rounded-lg text-sm bg-green-500/20 text-green-400">
    {{ toast }}
</div>
{% endif %}

{% if item %}
<div class="space-y-4">
    <!-- Header -->
    <div class="flex items-start justify-between">
        <div>
            <h3 class="text-lg font-semibold" style="color: var(--text-primary);">{{ item.title or 'Untitled' }}</h3>
            <p class="text-sm mt-1" style="color: var(--text-secondary);">
                {{ item.company or item.author or 'Unknown' }}
                {% if item.location %} â€” {{ item.location }}{% endif %}
            </p>
        </div>
        {% set score = item.relevance_score | default(0, true) %}
        <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg text-lg font-bold
            {% if score >= 9 %}bg-green-500/20 text-green-400
            {% elif score >= 7 %}bg-yellow-500/20 text-yellow-400
            {% else %}bg-gray-500/20 text-gray-400{% endif %}">
            {{ item.relevance_score or '?' }}
        </span>
    </div>

    <!-- Metadata -->
    <div class="flex flex-wrap gap-2 text-xs">
        <span class="px-2 py-1 rounded" style="background-color: var(--bg-hover); color: var(--text-secondary);">
            {{ item.type or 'unknown' }}
        </span>
        {% if item.classification %}
        <span class="px-2 py-1 rounded" style="background-color: var(--bg-hover); color: var(--text-secondary);">
            {{ item.classification.category or 'uncategorized' }}
        </span>
        {% for tag in item.classification.get('tags', []) %}
        <span class="px-2 py-1 rounded bg-indigo-600/20 text-indigo-400">{{ tag }}</span>
        {% endfor %}
        {% endif %}
        {% if item.edge_opportunities %}
        {% for edge in item.edge_opportunities %}
        <span class="px-2 py-1 rounded bg-purple-600/20 text-purple-400">{{ edge }}</span>
        {% endfor %}
        {% endif %}
    </div>

    <!-- Classification reasoning -->
    {% if item.classification and item.classification.reasoning %}
    <div class="rounded-lg p-3" style="background-color: var(--bg-secondary);">
        <p class="text-xs font-medium mb-1" style="color: var(--text-tertiary);">AI Assessment</p>
        <p class="text-sm" style="color: var(--text-secondary);">{{ item.classification.reasoning }}</p>
    </div>
    {% endif %}

    <!-- Edge details -->
    {% if item.edge_details %}
    <div class="rounded-lg p-3" style="background-color: rgba(147, 51, 234, 0.1);">
        <p class="text-xs font-medium mb-1 text-purple-400">Edge Signals</p>
        {% for edge in item.edge_details %}
        <p class="text-sm text-purple-300">+{{ edge.boost }} {{ edge.description }}</p>
        {% endfor %}
        {% if item.original_relevance_score %}
        <p class="text-xs mt-1 text-purple-400/70">Original score: {{ item.original_relevance_score }}/10</p>
        {% endif %}
    </div>
    {% endif %}

    <!-- Content -->
    <div class="text-sm leading-relaxed whitespace-pre-wrap" style="color: var(--text-primary);">{{ (item.full_content or item.content_preview or 'No content available')[:3000] }}</div>

    <!-- URL -->
    {% if item.url %}
    <a href="{{ item.url }}" target="_blank" rel="noopener"
       class="inline-flex items-center gap-1 text-sm text-indigo-400 hover:underline">
        Open on LinkedIn
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
        </svg>
    </a>
    {% endif %}

    <!-- Actions -->
    <div class="flex gap-2 pt-2 border-t" style="border-color: var(--border-default);">
        {% if item.type == 'job' and not item.acted_on %}
        <button hx-post="/dashboard/opportunities/{{ item._id }}/pipeline"
                hx-target="closest div"
                hx-swap="innerHTML"
                class="px-3 py-1.5 text-sm rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition-colors">
            Add to Pipeline
        </button>
        {% endif %}
        {% if not item.acted_on %}
        <button hx-post="/dashboard/opportunities/{{ item._id }}/action"
                hx-vals='{"action": "saved"}'
                hx-target="closest div"
                hx-swap="innerHTML"
                class="px-3 py-1.5 text-sm rounded-lg transition-colors"
                style="background-color: var(--bg-hover); color: var(--text-secondary);">
            Save
        </button>
        <button hx-post="/dashboard/opportunities/{{ item._id }}/action"
                hx-vals='{"action": "skipped"}'
                hx-target="closest div"
                hx-swap="innerHTML"
                class="px-3 py-1.5 text-sm rounded-lg text-red-400 transition-colors"
                style="background-color: var(--bg-hover);">
            Skip
        </button>
        {% else %}
        <span class="px-3 py-1.5 text-sm text-green-400">{{ item.acted_action or 'Acted' }}</span>
        {% endif %}
    </div>
</div>
{% endif %}
