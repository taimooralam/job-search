# Runner Service Configuration
# Copy this to .env and fill in your actual values

# =============================================================================
# RUNNER SERVICE SETTINGS
# =============================================================================

# Maximum number of concurrent pipeline runs (default: 3)
MAX_CONCURRENCY=3

# Maximum log lines to buffer per run (default: 500)
LOG_BUFFER_LIMIT=500

# Pipeline timeout in seconds (default: 600 = 10 minutes)
PIPELINE_TIMEOUT_SECONDS=600

# Environment (development, staging, production)
ENVIRONMENT=production

# =============================================================================
# PDF SERVICE (Runner â†’ PDF microservice)
# =============================================================================

# Base URL for PDF service calls.
# Use http://pdf-service:8001 inside Docker and http://localhost:8001 when running locally.
PDF_SERVICE_URL=http://pdf-service:8001

# =============================================================================
# SECURITY
# =============================================================================

# Shared secret for API authentication (REQUIRED in production)
# Generate with: openssl rand -hex 32
RUNNER_API_SECRET=your-secret-here-change-me

# CORS origins (comma-separated, no spaces)
# Example: https://your-app.vercel.app,https://staging.your-app.vercel.app
CORS_ORIGINS=https://your-app.vercel.app

# =============================================================================
# REDIS (Optional - for state persistence across restarts)
# =============================================================================

# Redis URL for state persistence (optional)
# If using n8n Redis: redis://redis:6379/5
REDIS_URL=redis://redis:6379/5

# =============================================================================
# MONGODB (Required for job data and status persistence)
# =============================================================================

# MongoDB connection URI
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/?retryWrites=true&w=majority

# =============================================================================
# PIPELINE SECRETS (Required for pipeline execution)
# These must match src/common/config.py requirements
# =============================================================================

# OpenAI API Key (for GPT models - used for all layers except CV generation)
OPENAI_API_KEY=sk-...

# Anthropic API Key (for Claude models - RECOMMENDED for CV generation to avoid OpenRouter rate limits)
# Get your key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-...

# OpenRouter API Key (alternative proxy for multiple models - NOT recommended due to rate limits)
OPENROUTER_API_KEY=sk-or-v1-...

# LLM Provider Selection for CV Generation (default: anthropic)
# Set to 'true' to use direct Anthropic API (recommended)
# Set to 'false' to use OpenRouter or OpenAI fallback
USE_ANTHROPIC=true
USE_OPENROUTER=false

# CV Model Configuration
# For direct Anthropic: claude-3-5-haiku-20241022
# For OpenRouter: anthropic/claude-3-5-haiku-20241022
CV_MODEL=claude-3-5-haiku-20241022

# FireCrawl API Key (for web scraping)
FIRECRAWL_API_KEY=fc-...

# =============================================================================
# LANGSMITH (Optional - for tracing and debugging)
# =============================================================================

# Enable LangSmith tracing (true/false)
LANGCHAIN_TRACING_V2=true

# LangSmith API Key
LANGCHAIN_API_KEY=ls__...

# LangSmith project name
LANGCHAIN_PROJECT=job-intelligence

# =============================================================================
# GOOGLE INTEGRATIONS (Optional - if using Drive/Sheets)
# =============================================================================

# Path to Google service account JSON file (inside container)
# GOOGLE_APPLICATION_CREDENTIALS=/app/credentials/service-account.json

# Google Drive folder ID for storing application artifacts
# GOOGLE_DRIVE_FOLDER_ID=...

# Google Sheets ID for tracking applications
# GOOGLE_SHEET_ID=...

# =============================================================================
# CLAUDE CODE CLI (Primary JD Extractor)
# Uses Claude Max subscription ($200/mo) for $0 marginal cost
# =============================================================================

# Enable Claude Code CLI extraction (requires auth setup - see docker-compose.runner.yml)
# Set to 'true' to enable the /api/jobs/{id}/extract endpoint
CLAUDE_CODE_ENABLED=true

# Claude model for JD extraction (default: claude-opus-4-5-20251101)
# Options: claude-opus-4-5-20251101, claude-sonnet-4-20250514
CLAUDE_CODE_MODEL=claude-opus-4-5-20251101

# CLI timeout in seconds (default: 120)
# Note: Opus 4.5 extraction typically takes 5-15 seconds
CLAUDE_CODE_TIMEOUT=120

# OAuth Token for Max Subscription (generated via 'claude setup-token')
# This token starts with 'sk-ant-oat01-' and provides $0 usage with Max subscription
ANTHROPIC_AUTH_TOKEN=sk-ant-oat01-YOUR-TOKEN-HERE

# Setup Instructions:
# 1. Install Claude Code CLI locally: npm install -g @anthropic-ai/claude-code
# 2. Login with browser: claude login
# 3. Generate long-lived token: claude setup-token
# 4. Copy the token (starts with sk-ant-oat01-) to ANTHROPIC_AUTH_TOKEN above
